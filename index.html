<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <meta name="description" content="운동 기록을 관리하고 추적하는 웹앱">
  <meta name="theme-color" content="#6c63ff">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <title>운동 트래커</title>

  <!-- PWA 매니페스트 -->
  <link rel="manifest" href="manifest.json">
  <link rel="icon" href="icons/icon.svg" type="image/svg+xml">
  <link rel="apple-touch-icon" href="icons/icon.svg">

  <!-- 구글 폰트: Pretendard 대신 Noto Sans KR 사용 -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap"
    rel="stylesheet">

  <!-- 스타일시트 -->
  <link rel="stylesheet" href="css/style.css">
</head>

<body>
  <!-- ============================================ -->
  <!-- 상단 헤더 -->
  <!-- ============================================ -->
  <header class="app-header">
    <h1 class="app-title">
      <span class="app-icon">🏋️</span>
      운동 트래커
    </h1>
  </header>

  <!-- ============================================ -->
  <!-- 메인 콘텐츠 영역 (각 탭 페이지) -->
  <!-- ============================================ -->
  <main class="app-content">

    <!-- ---- 탭 1: 홈 / 대시보드 ---- -->
    <section id="page-home" class="page active">
      <div class="dashboard">
        <!-- 오늘 날짜 카드 -->
        <div class="card card-date">
          <div class="card-label">오늘</div>
          <div class="card-value" id="today-date"></div>
        </div>

        <!-- 통계 카드들 -->
        <div class="stats-grid">
          <div class="card card-stat">
            <div class="card-label">이번 주 운동</div>
            <div class="card-value" id="stat-weekly">0<span class="unit">회</span></div>
          </div>
          <div class="card card-stat">
            <div class="card-label">총 운동 기록</div>
            <div class="card-value" id="stat-total">0<span class="unit">회</span></div>
          </div>
          <div class="card card-stat">
            <div class="card-label">등록된 운동</div>
            <div class="card-value" id="stat-exercises">0<span class="unit">개</span></div>
          </div>
        </div>

        <!-- 빠른 시작 버튼 -->
        <button class="btn btn-primary btn-large" id="btn-start-workout">
          <span class="btn-icon">💪</span>
          오늘의 운동 시작
        </button>

        <!-- 최근 기록 미리보기 -->
        <div class="card card-recent">
          <h3 class="card-title">최근 기록</h3>
          <div id="recent-records" class="recent-list">
            <p class="empty-message">아직 운동 기록이 없습니다.<br>운동을 시작해보세요!</p>
          </div>
        </div>
      </div>
    </section>

    <!-- ---- 탭 2: 운동하기 ---- -->
    <section id="page-workout" class="page">
      <!-- 운동 선택 화면 -->
      <div id="workout-select" class="workout-select">
        <h2 class="page-title">오늘의 운동</h2>
        <p class="page-subtitle">운동할 부위를 선택하세요</p>

        <!-- 부위별 필터 버튼 -->
        <div class="filter-chips" id="body-part-filters">
          <button class="chip active" data-filter="all">전체</button>
        </div>

        <!-- 운동 리스트 -->
        <div class="exercise-list" id="exercise-list">
          <p class="empty-message">운동 리스트가 없습니다.<br>엑셀 파일을 업로드해주세요.</p>
        </div>
      </div>

      <!-- 운동 기록 입력 화면 (운동 선택 후 표시) -->
      <div id="workout-input" class="workout-input" style="display:none;">
        <div class="workout-header">
          <button class="btn btn-ghost" id="btn-back-to-list">← 돌아가기</button>
          <h2 class="exercise-name" id="current-exercise-name"></h2>
          <p class="exercise-part" id="current-exercise-part"></p>
        </div>

        <!-- 세트 입력 테이블 -->
        <div class="sets-container">
          <div class="sets-header">
            <span class="set-col">세트</span>
            <span class="set-col">목표</span>
            <span class="set-col">RPE</span>
            <span class="set-col">중량(kg)</span>
            <span class="set-col">수행(회)</span>
            <span class="set-col">완료</span>
          </div>
          <div class="sets-list" id="sets-list">
            <!-- 세트 행들이 동적으로 추가됨 -->
          </div>
          <button class="btn btn-secondary btn-small" id="btn-add-set">
            + 세트 추가
          </button>
        </div>

        <button class="btn btn-primary" id="btn-save-workout">
          ✓ 운동 저장
        </button>
      </div>
    </section>

    <!-- ---- 탭 3: 기록 조회 ---- -->
    <section id="page-history" class="page">
      <h2 class="page-title">운동 기록</h2>

      <!-- 날짜 선택 -->
      <div class="date-picker">
        <button class="btn btn-ghost" id="btn-prev-date">◀</button>
        <input type="date" id="history-date" class="date-input">
        <button class="btn btn-ghost" id="btn-next-date">▶</button>
        <button class="btn btn-ghost btn-delete-date" id="btn-delete-date" title="해당 날짜 기록 전체 삭제">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16">
            <path
              d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z" />
            <path fill-rule="evenodd"
              d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z" />
          </svg>
        </button>
      </div>

      <!-- 기록 리스트 -->
      <div class="history-list" id="history-list">
        <p class="empty-message">해당 날짜의 기록이 없습니다.</p>
      </div>

      <!-- 차트 영역 -->
      <div class="card chart-card" style="display:none;" id="chart-container">
        <h3 class="card-title">운동 추이</h3>
        <canvas id="progress-chart"></canvas>
      </div>
    </section>

    <!-- ---- 탭 4: 설정 ---- -->
    <section id="page-settings" class="page">
      <h2 class="page-title">설정</h2>

      <!-- 설정 상단: 운동 리스트 관리(좌) & 타이머 설정(우) -->
      <div class="settings-row">
        <!-- 엑셀 업로드 (좌측) -->
        <div class="card card-setting">
          <h3 class="card-title">📊 운동 리스트 관리</h3>
          <p class="setting-desc">엑셀(.xlsx) 파일로 운동 리스트를 업로드하세요.</p>
          <label class="btn btn-secondary upload-btn" for="excel-upload">
            📁 파일 선택
          </label>
          <input type="file" id="excel-upload" accept=".xlsx,.xls" style="display:none;">
          <div id="upload-status" class="upload-status"></div>
        </div>

        <!-- 타이머 설정 (우측) -->
        <div class="card card-setting" style="border: 1px solid var(--accent);">
          <h3 class="card-title">⏱️ 휴식 타이머 설정</h3>
          <p class="setting-desc">세트 완료 후 자동으로 시작되는 휴식 시간입니다.</p>
          <div class="input-group" style="display: flex; align-items: center; gap: 10px; margin-top: 10px;">
            <input type="number" id="setting-timer-duration" class="set-input" value="60" min="5" step="5"
              style="width: 80px; text-align: center; background: var(--bg-secondary); border: 2px solid var(--accent);">
            <span style="font-weight: 600; color: var(--accent-light);">초</span>
          </div>
        </div>
      </div>

      <!-- 데이터 관리 -->
      <div class="card card-setting">
        <h3 class="card-title">💾 데이터 관리</h3>
        <button class="btn btn-secondary" id="btn-export-data">📤 데이터 내보내기</button>
        <button class="btn btn-danger" id="btn-clear-data">🗑️ 모든 데이터 삭제</button>
      </div>

      <!-- 현재 운동 목록 -->
      <div class="card card-setting">
        <h3 class="card-title">📋 등록된 운동 목록</h3>
        <div id="exercise-manage-list" class="exercise-manage-list">
          <p class="empty-message">등록된 운동이 없습니다.</p>
        </div>
      </div>
    </section>
  </main>

  <!-- ============================================ -->
  <!-- 하단 탭 네비게이션 -->
  <!-- ============================================ -->
  <nav class="tab-bar">
    <button class="tab-item active" data-page="home">
      <span class="tab-icon">🏠</span>
      <span class="tab-label">홈</span>
    </button>
    <button class="tab-item" data-page="workout">
      <span class="tab-icon">🏋️</span>
      <span class="tab-label">운동</span>
    </button>
    <button class="tab-item" data-page="history">
      <span class="tab-icon">📈</span>
      <span class="tab-label">기록</span>
    </button>
    <button class="tab-item" data-page="settings">
      <span class="tab-icon">⚙️</span>
      <span class="tab-label">설정</span>
    </button>
  </nav>

  <!-- ============================================ -->

  <!-- 토스트 알림 컨테이너 -->
  <div id="toast-container" class="toast-container"></div>

  <!-- ============================================ -->
  <!-- 스크립트 로드 (순서 중요) -->
  <!-- ============================================ -->
  <script src="lib/xlsx.full.min.js"></script>
  <script src="lib/chart.min.js"></script>
  <script src="js/db.js"></script>
  <script src="js/excel.js"></script>
  <script src="js/workout.js"></script>
  <script src="js/history.js"></script>
  <script src="js/app.js"></script>
</body>

</html>